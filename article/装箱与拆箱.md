
# 装箱与拆箱 #

装箱，一般表示结构包装为引用对象，参考-》隐式转换

	在堆中创建一个对象实例，然后将对象实例指向栈中的值

拆箱，一般表示为引用对象转换为结构，参考-》显示转换

	将堆中的值 全复制到栈中。

大量使用值类型会引起变量值的大量拷贝，反而降低运行效率。

所以装箱没有那么可怕

### office ###

对值类型装箱会在堆中分配一个对象实例，并将该值复制到新的对象中。

取消装箱操作包括：

- 检查对象实例，以确保它是给定值类型的装箱值。
- 将该值从实例复制到值类型变量中。

#### 性能 ####

如果值类型必须被频繁装箱，那么在这些情况下最好避免使用值类型（例如在诸如 System.Collections.ArrayList 的非泛型集合类中）。 可通过使用泛型集合（例如 System.Collections.Generic.List<T>）来避免装箱值类型。 装箱和取消装箱过程需要进行大量的计算。 对值类型进行装箱时，必须创建一个全新的对象。 这可能比简单的引用赋值用时最多长 20 倍。 取消装箱的过程所需时间可达赋值操作的四倍。 